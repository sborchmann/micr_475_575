---
title: "Homework 04: Data frames and data wrangling"
format: html
editor: visual
---

Please read the entire chapter on data transformation from\
[R for Data Science](https://r4ds.hadley.nz/data-transform) before starting this homework.

This homework relies on the `nycflights13` package, which contains several data frames, including:

-   `airlines`
-   `airports`
-   `flights`
-   `planes`
-   `weather`

Loading `nycflights13` puts these data frames on the search path.

------------------------------------------------------------------------

## Setup

### Load packages (do this every time)

```{r}
library(tidyverse)
library(nycflights13)
```

Note - if you don't have these installed you will need to first install.packages('nycflights13')

------------------------------------------------------------------------

# Question 1: Filtering

Make a plot of **air time vs distance** (air time on the y-axis, distance on the x-axis) for all flights that meet the following criteria:

-   originate from LaGuardia airport (`"LGA"`)
-   departed on the 16th of the month
-   have a flight distance of less than 2000 miles

## Your code

```{r}
# Filter flights according to the criteria above,
# then make the required plot.
filtered_flights <- nycflights13::flights |>
  filter(origin %in% 'LGA') |>
  filter(day == 16) |>
  filter(distance < 2000)

ggplot(
  data = filtered_flights,
  mapping = aes(x = distance, y = air_time)
) +
  geom_point(na.rm = TRUE)
```

## Brief written response

In 2–4 sentences, describe what you observe in the plot. (For example: Is the relationship roughly linear? Are there any clear outliers?)

**Your answer here:** The relationship is roughly linear. Each distance has a range of air time that is falls in to, with the ranges getting bigger as the distance is further. There are a few outliers with with longer air time than the other flights in the 1000-1200 range.

------------------------------------------------------------------------

# Question 2: Dealing with NAs

Make a data frame of all rows of `flights` that have values for *both* `arr_time` and `dep_time` (i.e., neither value is `NA`).

## Your code

```{r}
# Create a new data frame that removes rows where arr_time or dep_time is NA.
newflights <- flights |>
  filter(if_any(dep_time:arr_time, ~ !is.na(.)))
glimpse(newflights)
```

## Filtering NAs (conceptual)

`ggplot()` will automatically remove `NA` values from a plot, but it emits a warning message about it. You *could* silence warnings using chunk options, but instead:

### Brief written response

Explain (in words) how you could prevent those `NA` values from appearing in the plot in the first place.

**Your answer here:** You could prevent NA values from appearing in the plot by including 'na.rm = TRUE' to have ggplot remove all the NA values before proceeding with creating the plot.

------------------------------------------------------------------------

# Question 3: Adding columns

Create a data frame of **average flight speeds**, based on `air_time` and `distance`.

Then make either:

-   a histogram, **or**
-   a density plot

If you like, you may break the data out (e.g., by airline or another variable) in a way that you think makes sense.

## Your code

```{r}
# Create a new column for average speed.
# (Hint: think carefully about units — air_time is in minutes.)
# Then make a histogram or density plot.
avg_speed <- flights |>
  mutate(speed = distance / air_time * 60)

ggplot(
  data = avg_speed, 
  mapping = aes(x=speed)
) +
  geom_density(na.rm = TRUE)

```

## Brief written response

Describe the main features of your speed distribution.

**Your answer here:** Speed appears to have a normal distribution with a slight skew towards speeds above 400 miles per hour.

------------------------------------------------------------------------

# Rendering and submission (GitHub)

Canvas contains the course GitHub link and instructions for **forking** the course repository.

In this file, your job is to:

1.  Complete the homework by adding code + written responses above.
2.  Render this Quarto file to **HTML or PDF**.
3.  Move the rendered file(s) to the /doc folder (note that, if you render to html you will also have to move your hmk_04_data_frames_files folder)
4.  Add/commit both:
    -   this edited `.qmd` file
    -   the rendered output file(s) (HTML or PDF)
5.  Push your changes to your fork on GitHub.
6.  Open a Pull Request back to the course repository.

## What to submit on Canvas

On Canvas, submit a link to your GitHub fork repository (not files).
